<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eContademy | Transforma tu Futuro</title>
    
    <!-- SEO -->
    <meta name="description" content="Plataforma líder en educación online y recursos para emprendedores. Cursos certificados, herramientas y consultoría.">
    
    <!-- Estilos y Fuentes -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
    
    <!-- Configuración Tailwind Custom -->
    <script>
        tailwind.config = {
            theme: {
                fontFamily: { sans: ['Outfit', 'sans-serif'] },
                extend: {
                    colors: {
                        brand: { 50: '#eff6ff', 100: '#dbeafe', 500: '#3b82f6', 600: '#2563eb', 900: '#1e3a8a' },
                        dark: '#0f172a'
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.6s ease-out forwards',
                        'slide-up': 'slideUp 0.8s ease-out forwards'
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        slideUp: { '0%': { opacity: '0', transform: 'translateY(30px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } }
                    }
                }
            }
        }
    </script>

    <style>
        /* Estilos Críticos */
        .slider-wrapper { position: relative; height: 85vh; min-height: 600px; overflow: hidden; background: #000; }
        .slide { position: absolute; inset: 0; opacity: 0; transition: opacity 1.5s ease-in-out; display: flex; align-items: center; justify-content: center; }
        .slide.active { opacity: 1; z-index: 10; }
        .slide-overlay { background: linear-gradient(to top, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.4)); position: absolute; inset: 0; z-index: 2; }
        .slide-content { position: relative; z-index: 10; padding: 2rem; max-width: 1200px; width: 100%; }
        
        .glass-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2); }
        .iframe-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 12px; background: #000; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); }
        .iframe-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 flex flex-col min-h-screen">

    <!-- ================= NAVBAR SUPERIOR ================= -->
    <header class="fixed w-full z-50 transition-all duration-300 bg-white/90 backdrop-blur-md border-b border-slate-200" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <!-- Logo -->
                <a href="#" onclick="app.router('home')" class="flex items-center gap-2 group">
                    <div class="bg-brand-600 text-white p-2 rounded-xl shadow-lg group-hover:scale-105 transition transform duration-300">
                        <i data-lucide="zap" class="w-6 h-6"></i>
                    </div>
                    <div>
                        <span class="text-2xl font-bold tracking-tight text-slate-900 leading-none">eConta<span class="text-brand-600">demy</span></span>
                        <span class="text-xs text-slate-400 block tracking-widest uppercase font-semibold">Academy</span>
                    </div>
                </a>

                <!-- Menú Principal Desktop -->
                <nav class="hidden lg:flex items-center gap-8 font-medium text-slate-600">
                    <a href="#" onclick="app.router('home')" class="hover:text-brand-600 transition py-2 border-b-2 border-transparent hover:border-brand-600">Inicio</a>
                    <a href="#" onclick="app.router('store')" class="hover:text-brand-600 transition py-2 border-b-2 border-transparent hover:border-brand-600">Cursos & Tienda</a>
                    <a href="#" onclick="app.router('services')" class="hover:text-brand-600 transition py-2 border-b-2 border-transparent hover:border-brand-600">Servicios</a>
                    <a href="#" onclick="app.router('blog')" class="hover:text-brand-600 transition py-2 border-b-2 border-transparent hover:border-brand-600">Blog</a>
                    <a href="#" onclick="app.router('contact')" class="hover:text-brand-600 transition py-2 border-b-2 border-transparent hover:border-brand-600">Contacto</a>
                </nav>

                <!-- Iconos y Botones -->
                <div class="flex items-center gap-4">
                    <button onclick="app.toggleCart()" class="relative p-2.5 hover:bg-slate-100 rounded-full transition group">
                        <i data-lucide="shopping-bag" class="w-6 h-6 text-slate-700 group-hover:text-brand-600"></i>
                        <span id="cart-badge" class="absolute top-0 right-0 bg-red-500 text-white text-[10px] font-bold h-5 w-5 flex items-center justify-center rounded-full border-2 border-white transform scale-0 transition-transform">0</span>
                    </button>
                    
                    <button onclick="app.router('lms')" class="hidden md:flex bg-slate-900 text-white px-6 py-2.5 rounded-full font-bold text-sm hover:bg-slate-800 transition shadow-lg shadow-slate-900/20 items-center gap-2 hover:-translate-y-0.5 transform">
                        <i data-lucide="user-circle" class="w-4 h-4"></i> Aula Virtual
                    </button>

                    <!-- Mobile Toggle -->
                    <button class="lg:hidden text-slate-700 p-2" onclick="document.getElementById('mobile-menu').classList.toggle('hidden')">
                        <i data-lucide="menu" class="w-7 h-7"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Menú Móvil -->
        <div id="mobile-menu" class="hidden lg:hidden bg-white border-t border-slate-100 absolute w-full shadow-xl">
            <div class="flex flex-col p-4 space-y-4 font-medium text-center">
                <a href="#" onclick="app.router('home');document.getElementById('mobile-menu').classList.add('hidden')">Inicio</a>
                <a href="#" onclick="app.router('store');document.getElementById('mobile-menu').classList.add('hidden')">Tienda</a>
                <a href="#" onclick="app.router('services');document.getElementById('mobile-menu').classList.add('hidden')">Servicios</a>
                <a href="#" onclick="app.router('lms');document.getElementById('mobile-menu').classList.add('hidden')" class="bg-brand-50 text-brand-600 py-2 rounded-lg">Aula Virtual</a>
            </div>
        </div>
    </header>

    <!-- ================= CONTENEDOR PRINCIPAL (SPA) ================= -->
    <main id="main-view" class="flex-grow pt-20">
        <!-- VISTAS SE INYECTAN AQUÍ CON JS -->
    </main>

    <!-- ================= FOOTER PREMIUM ================= -->
    <footer class="bg-dark text-slate-400 pt-20 pb-10 border-t border-slate-800 mt-auto">
        <div class="max-w-7xl mx-auto px-4 grid md:grid-cols-4 gap-12 mb-16">
            <div class="col-span-1 md:col-span-2">
                <div class="flex items-center gap-2 text-white mb-6">
                    <i data-lucide="zap" class="w-6 h-6 text-brand-500"></i>
                    <span class="text-2xl font-bold">eContademy</span>
                </div>
                <p class="mb-6 max-w-sm leading-relaxed">Transformamos la educación digital. Aprende habilidades reales, obtén certificaciones y lleva tu carrera al siguiente nivel.</p>
                <div class="flex gap-4">
                    <a href="#" class="bg-white/10 p-2 rounded-full hover:bg-brand-600 hover:text-white transition"><i data-lucide="instagram" class="w-5 h-5"></i></a>
                    <a href="#" class="bg-white/10 p-2 rounded-full hover:bg-brand-600 hover:text-white transition"><i data-lucide="linkedin" class="w-5 h-5"></i></a>
                    <a href="#" class="bg-white/10 p-2 rounded-full hover:bg-brand-600 hover:text-white transition"><i data-lucide="twitter" class="w-5 h-5"></i></a>
                </div>
            </div>
            <div>
                <h4 class="text-white font-bold mb-6 text-lg">Explorar</h4>
                <ul class="space-y-4">
                    <li><a href="#" onclick="app.router('store')" class="hover:text-brand-500 transition">Todos los Cursos</a></li>
                    <li><a href="#" onclick="app.router('services')" class="hover:text-brand-500 transition">Servicios Corporativos</a></li>
                    <li><a href="#" onclick="app.router('blog')" class="hover:text-brand-500 transition">Blog & Recursos</a></li>
                </ul>
            </div>
            <div>
                <h4 class="text-white font-bold mb-6 text-lg">Legal</h4>
                <ul class="space-y-4">
                    <li><a href="#" class="hover:text-brand-500 transition">Términos y Condiciones</a></li>
                    <li><a href="#" class="hover:text-brand-500 transition">Política de Privacidad</a></li>
                    <li><a href="#" onclick="app.router('contact')" class="hover:text-brand-500 transition">Ayuda / Soporte</a></li>
                </ul>
            </div>
        </div>
        <div class="max-w-7xl mx-auto px-4 pt-8 border-t border-slate-800 text-center text-sm">
            <p>&copy; 2024 eContademy. Todos los derechos reservados.</p>
        </div>
    </footer>

    <!-- ================= ELEMENTOS FLOTANTES ================= -->
    
    <!-- Modal Carrito -->
    <div id="cart-sidebar" class="fixed inset-0 z-[60] hidden">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity" onclick="app.toggleCart()"></div>
        <div class="absolute right-0 top-0 h-full w-full max-w-md bg-white shadow-2xl transform transition-transform duration-300 flex flex-col animate-slide-left">
            <div class="p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50">
                <div class="flex items-center gap-2">
                    <i data-lucide="shopping-bag" class="text-brand-600"></i>
                    <h2 class="text-xl font-bold text-slate-900">Tu Carrito</h2>
                </div>
                <button onclick="app.toggleCart()" class="text-slate-400 hover:text-red-500 transition"><i data-lucide="x"></i></button>
            </div>
            
            <div id="cart-content" class="flex-1 overflow-y-auto p-6 space-y-4">
                <!-- Items Inyectados -->
            </div>
            
            <div class="p-6 bg-slate-50 border-t border-slate-200 shadow-[0_-5px_15px_rgba(0,0,0,0.05)]">
                <div class="flex justify-between items-end mb-4">
                    <span class="text-slate-500 font-medium">Subtotal</span>
                    <span id="cart-total" class="text-2xl font-bold text-slate-900">$0.00</span>
                </div>
                <button onclick="app.openCheckout()" class="w-full bg-slate-900 text-white py-4 rounded-xl font-bold text-lg hover:bg-brand-600 transition shadow-lg flex justify-center items-center gap-2">
                    Procesar Pago <i data-lucide="arrow-right" class="w-5 h-5"></i>
                </button>
                <p class="text-xs text-center text-slate-400 mt-3"><i data-lucide="shield-check" class="w-3 h-3 inline"></i> Pago 100% Seguro</p>
            </div>
        </div>
    </div>

    <!-- Modal Checkout -->
    <div id="checkout-modal" class="fixed inset-0 z-[70] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-dark/80 backdrop-blur-sm" onclick="document.getElementById('checkout-modal').classList.add('hidden')"></div>
        <div class="bg-white rounded-2xl w-full max-w-md relative z-10 overflow-hidden shadow-2xl animate-scale-up">
            <div class="bg-gradient-to-r from-slate-900 to-slate-800 p-6 text-white text-center">
                <h3 class="text-2xl font-bold">Finalizar Pedido</h3>
                <p class="text-slate-300 text-sm mt-1">Ingresa tus datos para recibir el acceso.</p>
            </div>
            <div class="p-8">
                <form onsubmit="app.submitOrder(event)" class="space-y-5">
                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-1">Nombre Completo</label>
                        <input type="text" id="chk-name" required class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-brand-500 outline-none transition">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-1">Correo Electrónico</label>
                        <input type="email" id="chk-email" placeholder="ejemplo@correo.com" required class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-brand-500 outline-none transition">
                        <p class="text-xs text-brand-600 mt-1">⚠️ Importante: Aquí enviaremos tus credenciales.</p>
                    </div>
                    <button type="submit" class="w-full bg-brand-600 text-white py-3.5 rounded-xl font-bold hover:bg-brand-700 transition shadow-lg mt-2">
                        Confirmar y Pagar
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-8 right-8 bg-slate-800 text-white px-6 py-4 rounded-xl shadow-2xl flex items-center gap-4 transform translate-y-20 opacity-0 transition-all duration-500 z-[80]">
        <div class="bg-green-500 rounded-full p-1"><i data-lucide="check" class="w-4 h-4 text-white"></i></div>
        <div>
            <h4 class="font-bold text-sm">Notificación</h4>
            <p id="toast-msg" class="text-xs text-slate-300">Mensaje del sistema</p>
        </div>
    </div>

    <!-- ================= CÓDIGO JS MAESTRO ================= -->
    <script>
        // CONFIGURACIÓN (Rellena esto)
        const API_URL = "https://script.google.com/macros/s/AKfycbwaJXcW8rXDmobm2apiqCr-lLaCij8t8E_pWaQOoTR0yzo85stb72usmi-TpqiNvino1Q/exec"; 
        const MOCK_MODE = false; // CAMBIAR A FALSE EN PRODUCCIÓN

        const app = {
            data: { products: [], blog: [], services: [] },
            cart: JSON.parse(localStorage.getItem('ef_cart')) || [],
            user: null,

            // --- INICIO ---
            init: async () => {
                lucide.createIcons();
                app.updateCartUI();
                await app.fetchData();
                app.router('home');
                app.initSlider();
            },

            // --- DATA FETCHING ---
            fetchData: async () => {
                if (MOCK_MODE) {
                    // Datos Demo Completos
                    await new Promise(r => setTimeout(r, 600));
                    app.data.products = [
                        {id:'1', titulo:'Máster en Desarrollo Web', precio:99.99, categoria:'Curso', imagen:'https://images.unsplash.com/photo-1498050108023-c5249f4df085?auto=format&fit=crop&w=600', descripcion:'De cero a experto en HTML, CSS, JS y React.'},
                        {id:'2', titulo:'Kit Electrónica Básica', precio:45.00, categoria:'Físico', imagen:'https://images.unsplash.com/photo-1555664424-778a6902201b?auto=format&fit=crop&w=600', descripcion:'Arduino, sensores y cables para empezar.'},
                        {id:'3', titulo:'Finanzas para No Financieros', precio:29.99, categoria:'Curso', imagen:'https://images.unsplash.com/photo-1554224155-6726b3ff858f?auto=format&fit=crop&w=600', descripcion:'Maneja tu dinero inteligentemente.'},
                        {id:'4', titulo:'Inglés de Negocios', precio:59.00, categoria:'Curso', imagen:'https://images.unsplash.com/photo-1557804506-669a67965ba0?auto=format&fit=crop&w=600', descripcion:'Fluidez para reuniones internacionales.'}
                    ];
                    app.data.blog = [
                        {id:'b1', titulo:'Cómo estudiar online efectivamente', autor:'Ana García', fecha:'20/11/2024', imagen:'https://images.unsplash.com/photo-1434030216411-0b793f4b4173?w=600', contenido:'Tips de productividad...'},
                        {id:'b2', titulo:'El futuro de la IA en 2025', autor:'Carlos Dev', fecha:'18/11/2024', imagen:'https://images.unsplash.com/photo-1677442136019-21780ecad995?w=600', contenido:'Análisis de tendencias...'}
                    ];
                    app.data.services = [
                        {id:'s1', titulo:'Consultoría IT', descripcion:'Auditoría de sistemas y optimización.', precio:'Desde $500', icono:'server'},
                        {id:'s2', titulo:'Capacitación In-Company', descripcion:'Formamos a tu equipo en nuevas tecnologías.', precio:'A cotizar', icono:'users'}
                    ];
                } else {
                    try {
                        const res = await fetch(API_URL);
                        const json = await res.json();
                        app.data = json;
                    } catch(e) { app.showToast("Error de conexión"); }
                }
            },

            // --- NAVEGACIÓN (VISTAS) ---
            router: (view) => {
                const main = document.getElementById('main-view');
                window.scrollTo(0,0);
                
                // 1. HOME VIEW (Estructura de Ventas)
                if (view === 'home') {
                    main.innerHTML = `
                        <!-- HERO SLIDER -->
                        <div class="slider-wrapper">
                            <!-- Slide 1 -->
                            <div class="slide active">
                                <img src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?auto=format&fit=crop&w=1920" class="absolute inset-0 w-full h-full object-cover">
                                <div class="slide-overlay"></div>
                                <div class="slide-content text-center text-white animate-slide-up">
                                    <h3 class="text-brand-400 font-bold tracking-widest uppercase mb-4 text-sm md:text-base">Plataforma Educativa #1</h3>
                                    <h1 class="text-5xl md:text-7xl font-extrabold mb-6 leading-tight">Impulsa tu Carrera <br>al <span class="text-brand-500">Siguiente Nivel</span></h1>
                                    <p class="text-lg md:text-xl text-slate-300 mb-8 max-w-2xl mx-auto">Accede a cursos prácticos, mentoría experta y herramientas que realmente necesitas.</p>
                                    <div class="flex flex-col md:flex-row gap-4 justify-center">
                                        <button onclick="app.router('store')" class="bg-brand-600 text-white px-8 py-4 rounded-full font-bold hover:bg-brand-700 transition shadow-lg shadow-brand-600/30">Explorar Cursos</button>
                                        <button onclick="app.router('contact')" class="bg-white/10 backdrop-blur border border-white/20 text-white px-8 py-4 rounded-full font-bold hover:bg-white hover:text-dark transition">Contáctanos</button>
                                    </div>
                                </div>
                            </div>
                            <!-- Slide 2 (Video Mock) -->
                            <div class="slide">
                                <div class="absolute inset-0 bg-brand-900"></div> <!-- Fallback color -->
                                <img src="https://images.unsplash.com/photo-1531297425935-9ae8ac68f432?auto=format&fit=crop&w=1920" class="absolute inset-0 w-full h-full object-cover opacity-50">
                                <div class="slide-content text-left text-white max-w-4xl mx-auto pl-4 md:pl-0">
                                    <h3 class="text-yellow-400 font-bold uppercase mb-4">Nueva Temporada</h3>
                                    <h1 class="text-5xl md:text-7xl font-extrabold mb-6">Aprende Haciendo</h1>
                                    <p class="text-xl mb-8">Proyectos reales. Código real. Resultados reales.</p>
                                </div>
                            </div>
                        </div>

                        <!-- BARRA DE CONFIANZA (Debajo del Slider) -->
                        <div class="bg-white border-b border-slate-100 py-10 relative z-20 -mt-2 rounded-t-3xl shadow-xl mx-2 md:mx-0">
                            <div class="max-w-7xl mx-auto px-4 grid grid-cols-2 md:grid-cols-4 gap-8 text-center">
                                <div><h4 class="text-3xl font-extrabold text-slate-900">5k+</h4><p class="text-slate-500 text-sm">Estudiantes</p></div>
                                <div><h4 class="text-3xl font-extrabold text-slate-900">120+</h4><p class="text-slate-500 text-sm">Cursos</p></div>
                                <div><h4 class="text-3xl font-extrabold text-slate-900">4.9/5</h4><p class="text-slate-500 text-sm">Valoración</p></div>
                                <div><h4 class="text-3xl font-extrabold text-slate-900">24/7</h4><p class="text-slate-500 text-sm">Soporte</p></div>
                            </div>
                        </div>

                        <!-- PRODUCTOS DESTACADOS (Conversión Inmediata) -->
                        <section class="py-20 bg-slate-50">
                            <div class="max-w-7xl mx-auto px-4">
                                <div class="text-center mb-16">
                                    <span class="text-brand-600 font-bold uppercase text-sm tracking-wider">Oportunidades</span>
                                    <h2 class="text-3xl md:text-4xl font-extrabold text-slate-900 mt-2">Cursos Más Vendidos</h2>
                                    <div class="w-20 h-1.5 bg-brand-500 mx-auto mt-6 rounded-full"></div>
                                </div>
                                <div class="grid md:grid-cols-3 gap-8">
                                    ${app.data.products.slice(0, 3).map(p => app.components.productCard(p)).join('')}
                                </div>
                                <div class="text-center mt-12">
                                    <button onclick="app.router('store')" class="text-slate-600 font-bold hover:text-brand-600 flex items-center gap-2 mx-auto border-b-2 border-slate-200 pb-1 hover:border-brand-600 transition">Ver Catálogo Completo <i data-lucide="arrow-right" class="w-4 h-4"></i></button>
                                </div>
                            </div>
                        </section>

                        <!-- POR QUÉ ELEGIRNOS -->
                        <section class="py-20 bg-white">
                            <div class="max-w-7xl mx-auto px-4 grid md:grid-cols-2 gap-16 items-center">
                                <div class="grid grid-cols-2 gap-6">
                                    <div class="bg-brand-50 p-6 rounded-2xl"><i data-lucide="award" class="w-10 h-10 text-brand-600 mb-4"></i><h4 class="font-bold">Certificado</h4><p class="text-sm text-slate-500">Validez internacional.</p></div>
                                    <div class="bg-indigo-50 p-6 rounded-2xl mt-8"><i data-lucide="video" class="w-10 h-10 text-indigo-600 mb-4"></i><h4 class="font-bold">HD Video</h4><p class="text-sm text-slate-500">Calidad cine.</p></div>
                                    <div class="bg-emerald-50 p-6 rounded-2xl"><i data-lucide="infinity" class="w-10 h-10 text-emerald-600 mb-4"></i><h4 class="font-bold">Acceso Total</h4><p class="text-sm text-slate-500">De por vida.</p></div>
                                    <div class="bg-orange-50 p-6 rounded-2xl mt-8"><i data-lucide="users" class="w-10 h-10 text-orange-600 mb-4"></i><h4 class="font-bold">Comunidad</h4><p class="text-sm text-slate-500">Network activo.</p></div>
                                </div>
                                <div>
                                    <h2 class="text-3xl md:text-4xl font-extrabold mb-6 text-slate-900">Aprendizaje diseñado para humanos, no robots.</h2>
                                    <p class="text-slate-500 text-lg mb-8 leading-relaxed">Olvídate de la teoría aburrida. En eContademy nos enfocamos en proyectos tangibles que puedes poner en tu portafolio hoy mismo.</p>
                                    <ul class="space-y-4 mb-8">
                                        <li class="flex items-center gap-3"><i data-lucide="check-circle" class="text-green-500"></i> Instructores con experiencia real.</li>
                                        <li class="flex items-center gap-3"><i data-lucide="check-circle" class="text-green-500"></i> Actualizaciones gratuitas.</li>
                                        <li class="flex items-center gap-3"><i data-lucide="check-circle" class="text-green-500"></i> Garantía de devolución.</li>
                                    </ul>
                                </div>
                            </div>
                        </section>
                    `;
                }

                // 2. STORE VIEW
                else if (view === 'store') {
                    main.innerHTML = `
                        <div class="bg-slate-900 py-16 text-center text-white">
                            <h1 class="text-4xl font-bold">Tienda Oficial</h1>
                            <p class="text-slate-400 mt-2">Invierte en herramientas y conocimiento.</p>
                        </div>
                        <div class="max-w-7xl mx-auto px-4 py-16">
                            <!-- Filtros simples (Visuales) -->
                            <div class="flex gap-4 mb-10 overflow-x-auto pb-4">
                                <button class="px-6 py-2 bg-brand-600 text-white rounded-full font-bold whitespace-nowrap">Todos</button>
                                <button class="px-6 py-2 bg-white border border-slate-200 text-slate-600 rounded-full font-medium hover:border-brand-600 whitespace-nowrap">Cursos</button>
                                <button class="px-6 py-2 bg-white border border-slate-200 text-slate-600 rounded-full font-medium hover:border-brand-600 whitespace-nowrap">Herramientas</button>
                            </div>
                            <div class="grid md:grid-cols-3 lg:grid-cols-4 gap-8">
                                ${app.data.products.map(p => app.components.productCard(p)).join('')}
                            </div>
                        </div>
                    `;
                }

                // 3. SERVICES VIEW
                else if (view === 'services') {
                    main.innerHTML = `
                        <div class="max-w-7xl mx-auto px-4 py-20">
                            <div class="text-center mb-16">
                                <h2 class="text-4xl font-bold text-slate-900">Soluciones Corporativas</h2>
                                <p class="text-xl text-slate-500 mt-4 max-w-2xl mx-auto">Llevamos la transformación digital a tu empresa.</p>
                            </div>
                            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                                ${app.data.services.map(s => `
                                    <div class="bg-white p-8 rounded-2xl shadow-sm border border-slate-100 hover:shadow-xl transition group">
                                        <div class="w-14 h-14 bg-brand-50 rounded-xl flex items-center justify-center text-brand-600 mb-6 group-hover:bg-brand-600 group-hover:text-white transition">
                                            <i data-lucide="${s.icono || 'star'}" class="w-7 h-7"></i>
                                        </div>
                                        <h3 class="text-2xl font-bold mb-3">${s.titulo}</h3>
                                        <p class="text-slate-500 mb-6">${s.descripcion}</p>
                                        <div class="mt-auto border-t border-slate-100 pt-6 flex justify-between items-center">
                                            <span class="font-bold text-slate-900">${s.precio}</span>
                                            <button onclick="app.router('contact')" class="text-brand-600 font-bold text-sm">Cotizar →</button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }

                // 4. BLOG VIEW
                else if (view === 'blog') {
                    main.innerHTML = `
                        <div class="max-w-5xl mx-auto px-4 py-16">
                            <h2 class="text-4xl font-bold mb-10 border-l-4 border-brand-500 pl-4">Blog & Novedades</h2>
                            <div class="space-y-12">
                                ${app.data.blog.map(post => `
                                    <article class="flex flex-col md:flex-row gap-8 items-start">
                                        <img src="${post.imagen}" class="w-full md:w-64 h-48 object-cover rounded-xl shadow-md">
                                        <div class="flex-1">
                                            <div class="flex items-center gap-4 text-xs font-bold uppercase tracking-wider text-slate-400 mb-2">
                                                <span>${post.fecha}</span> • <span>${post.autor}</span>
                                            </div>
                                            <h3 class="text-2xl font-bold mb-3 text-slate-900 hover:text-brand-600 cursor-pointer transition">${post.titulo}</h3>
                                            <p class="text-slate-600 leading-relaxed mb-4 line-clamp-3">${post.contenido}</p>
                                            <button class="text-brand-600 font-bold text-sm">Leer Artículo Completo</button>
                                        </div>
                                    </article>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }

                // 5. CONTACT VIEW
                else if (view === 'contact') {
                    main.innerHTML = `
                        <div class="max-w-7xl mx-auto px-4 py-20">
                            <div class="grid md:grid-cols-2 gap-16 bg-white rounded-3xl shadow-2xl overflow-hidden">
                                <div class="bg-slate-900 p-12 text-white flex flex-col justify-between">
                                    <div>
                                        <h2 class="text-3xl font-bold mb-6">Hablemos de tu Proyecto</h2>
                                        <p class="text-slate-400 mb-8">Estamos listos para responder tus dudas.</p>
                                        <div class="space-y-6">
                                            <div class="flex items-center gap-4"><div class="bg-white/10 p-3 rounded-full"><i data-lucide="map-pin"></i></div><p>Av. Innovación 123, Tech City</p></div>
                                            <div class="flex items-center gap-4"><div class="bg-white/10 p-3 rounded-full"><i data-lucide="mail"></i></div><p>hola@eContademy.com</p></div>
                                            <div class="flex items-center gap-4"><div class="bg-white/10 p-3 rounded-full"><i data-lucide="phone"></i></div><p>+1 234 567 890</p></div>
                                        </div>
                                    </div>
                                    <div class="mt-12 opacity-50"><i data-lucide="globe" class="w-48 h-48 absolute -bottom-10 -left-10 text-white/5"></i></div>
                                </div>
                                <div class="p-12">
                                    <form onsubmit="app.handlers.submitContact(event)" class="space-y-6">
                                        <div class="grid md:grid-cols-2 gap-6">
                                            <div><label class="block font-bold text-sm mb-2">Nombre</label><input type="text" id="c-name" class="w-full bg-slate-50 border border-slate-200 p-3 rounded-lg outline-none focus:border-brand-500"></div>
                                            <div><label class="block font-bold text-sm mb-2">Email</label><input type="email" id="c-email" class="w-full bg-slate-50 border border-slate-200 p-3 rounded-lg outline-none focus:border-brand-500"></div>
                                        </div>
                                        <div><label class="block font-bold text-sm mb-2">Asunto</label><input type="text" id="c-subject" class="w-full bg-slate-50 border border-slate-200 p-3 rounded-lg outline-none focus:border-brand-500"></div>
                                        <div><label class="block font-bold text-sm mb-2">Mensaje</label><textarea id="c-msg" rows="4" class="w-full bg-slate-50 border border-slate-200 p-3 rounded-lg outline-none focus:border-brand-500"></textarea></div>
                                        <button type="submit" class="w-full bg-brand-600 text-white py-4 rounded-xl font-bold shadow-lg hover:bg-brand-700 transition">Enviar Mensaje</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    `;
                }

                // 6. LMS VIEW (Aula Virtual)
                else if (view === 'lms') {
                    if (!app.user) {
                        main.innerHTML = `
                            <div class="min-h-[80vh] flex items-center justify-center px-4 bg-slate-100">
                                <div class="bg-white p-10 rounded-3xl shadow-2xl w-full max-w-md text-center">
                                    <div class="w-20 h-20 bg-brand-50 rounded-full flex items-center justify-center mx-auto mb-6 text-brand-600"><i data-lucide="lock" class="w-10 h-10"></i></div>
                                    <h2 class="text-3xl font-bold mb-2">Acceso Estudiantes</h2>
                                    <p class="text-slate-500 mb-8">Ingresa tus credenciales de compra.</p>
                                    <form onsubmit="app.handlers.login(event)" class="space-y-4 text-left">
                                        <div><label class="font-bold text-xs uppercase text-slate-400">Email</label><input type="email" id="lms-email" class="w-full border-b-2 border-slate-200 py-2 outline-none focus:border-brand-600 transition"></div>
                                        <div><label class="font-bold text-xs uppercase text-slate-400">ID Pedido (Contraseña)</label><input type="password" id="lms-pass" class="w-full border-b-2 border-slate-200 py-2 outline-none focus:border-brand-600 transition"></div>
                                        <button type="submit" class="w-full bg-slate-900 text-white py-4 rounded-xl font-bold mt-4 hover:bg-slate-800 transition">Ingresar al Aula</button>
                                    </form>
                                </div>
                            </div>
                        `;
                    } else {
                        main.innerHTML = `
                            <div class="bg-slate-900 text-white py-8 px-4"><div class="max-w-7xl mx-auto flex justify-between items-center"><div><h2 class="text-2xl font-bold">Hola, ${app.user.nombre}</h2><p class="text-slate-400">Bienvenido a tu espacio de aprendizaje.</p></div><button onclick="app.user=null;app.router('lms')" class="text-red-400 font-bold text-sm">Cerrar Sesión</button></div></div>
                            <div class="max-w-7xl mx-auto px-4 py-12 space-y-12">
                                ${app.user.cursos.length ? app.user.cursos.map(c => `
                                    <div class="bg-white rounded-2xl shadow-lg border border-slate-100 overflow-hidden">
                                        <div class="p-4 border-b bg-slate-50 flex items-center gap-3"><i data-lucide="play-circle" class="text-brand-600"></i><h3 class="font-bold text-lg">${c.titulo}</h3></div>
                                        <div class="grid lg:grid-cols-3">
                                            <div class="lg:col-span-2 bg-black p-4">${c.videoUrl ? `<div class="iframe-container"><iframe src="${c.videoUrl}" frameborder="0" allowfullscreen></iframe></div>` : '<div class="h-64 flex items-center justify-center text-slate-500">Video no disponible</div>'}</div>
                                            <div class="p-8">
                                                <h4 class="font-bold text-slate-900 mb-4">Material del Curso</h4>
                                                <a href="${c.materialUrl || '#'}" target="_blank" class="flex items-center gap-3 p-4 border border-dashed border-slate-300 rounded-xl hover:border-brand-500 hover:bg-brand-50 transition group"><div class="bg-slate-100 p-2 rounded group-hover:bg-white"><i data-lucide="download" class="text-slate-600 group-hover:text-brand-600"></i></div><div><p class="font-bold text-sm">Descargar Archivos</p><p class="text-xs text-slate-400">PDFs, Ejercicios</p></div></a>
                                            </div>
                                        </div>
                                    </div>
                                `).join('') : '<div class="text-center py-20"><p class="text-xl text-slate-400">No tienes cursos activos.</p></div>'}
                            </div>
                        `;
                    }
                }
                
                lucide.createIcons();
            },

            // --- COMPONENTES VISUALES ---
            components: {
                productCard: (p) => `
                    <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden flex flex-col hover:shadow-2xl hover:-translate-y-2 transition duration-300 group">
                        <div class="h-56 relative overflow-hidden">
                            <img src="${p.imagen}" class="w-full h-full object-cover group-hover:scale-110 transition duration-700">
                            <span class="absolute top-3 left-3 bg-white/90 backdrop-blur px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider shadow-sm">${p.categoria}</span>
                        </div>
                        <div class="p-6 flex-1 flex flex-col">
                            <h3 class="font-bold text-lg text-slate-900 mb-2 leading-tight">${p.titulo}</h3>
                            <p class="text-slate-500 text-sm mb-6 line-clamp-2 flex-1">${p.descripcion}</p>
                            <div class="flex items-center justify-between mt-auto">
                                <span class="text-2xl font-extrabold text-slate-900">$${p.precio}</span>
                                <button onclick="app.addToCart('${p.id}')" class="bg-brand-600 text-white w-10 h-10 rounded-xl flex items-center justify-center hover:bg-slate-900 transition shadow-lg shadow-brand-500/30">
                                    <i data-lucide="plus" class="w-5 h-5"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `
            },

            // --- LÓGICA DE NEGOCIO ---
            addToCart: (id) => {
                const prod = app.data.products.find(p => p.id === id);
                const exist = app.cart.find(i => i.id === id);
                exist ? exist.qty++ : app.cart.push({ ...prod, qty: 1 });
                app.saveCart();
                app.showToast(`Agregado: ${prod.titulo}`);
            },
            
            removeFromCart: (id) => {
                app.cart = app.cart.filter(i => i.id !== id);
                app.saveCart();
            },

            saveCart: () => {
                localStorage.setItem('ef_cart', JSON.stringify(app.cart));
                app.updateCartUI();
            },

            updateCartUI: () => {
                const badge = document.getElementById('cart-badge');
                const totalQty = app.cart.reduce((a, b) => a + b.qty, 0);
                badge.innerText = totalQty;
                badge.classList.toggle('scale-0', totalQty === 0);

                const container = document.getElementById('cart-content');
                if (container) {
                    if (app.cart.length === 0) {
                        container.innerHTML = '<div class="flex flex-col items-center justify-center h-full text-slate-400"><i data-lucide="shopping-cart" class="w-12 h-12 mb-2 opacity-20"></i><p>Tu carrito está vacío</p></div>';
                        document.getElementById('cart-total').innerText = "$0.00";
                    } else {
                        container.innerHTML = app.cart.map(i => `
                            <div class="flex gap-4 bg-white p-3 rounded-xl border border-slate-100 shadow-sm">
                                <img src="${i.imagen}" class="w-16 h-16 rounded-lg object-cover">
                                <div class="flex-1">
                                    <h4 class="font-bold text-sm text-slate-900 line-clamp-1">${i.titulo}</h4>
                                    <div class="flex justify-between items-center mt-2">
                                        <span class="text-xs text-slate-500 font-medium">$${i.precio} x ${i.qty}</span>
                                        <button onclick="app.removeFromCart('${i.id}')" class="text-red-400 hover:text-red-600 bg-red-50 p-1 rounded"><i data-lucide="trash-2" class="w-3 h-3"></i></button>
                                    </div>
                                </div>
                            </div>
                        `).join('');
                        const total = app.cart.reduce((a, b) => a + (b.precio * b.qty), 0);
                        document.getElementById('cart-total').innerText = `$${total.toFixed(2)}`;
                    }
                    lucide.createIcons();
                }
            },

            // --- HANDLERS DE FORMULARIOS ---
            handlers: {
                submitOrder: async (e) => {
                    e.preventDefault();
                    if(app.cart.length === 0) return alert("Carrito vacío");
                    
                    const btn = e.target.querySelector('button');
                    const oldText = btn.innerText;
                    btn.innerText = "Procesando..."; btn.disabled = true;

                    const payload = {
                        action: 'checkout',
                        nombre: document.getElementById('chk-name').value,
                        email: document.getElementById('chk-email').value,
                        carrito: app.cart,
                        total: document.getElementById('cart-total').innerText
                    };

                    await app.sendData(payload, (res) => {
                        app.cart = []; app.saveCart();
                        document.getElementById('checkout-modal').classList.add('hidden');
                        alert(`¡PEDIDO EXITOSO!\n\nID Pedido: ${res.idPedido}\n\nGuarda este ID, es tu contraseña para el Aula Virtual.`);
                    });
                    btn.innerText = oldText; btn.disabled = false;
                },

                login: async (e) => {
                    e.preventDefault();
                    const btn = e.target.querySelector('button');
                    btn.innerText = "Verificando...";
                    
                    if(MOCK_MODE) { // Mock Login
                        setTimeout(() => {
                            app.user = { nombre: 'Estudiante Demo', cursos: [{titulo:'Curso Demo', videoUrl:'https://www.youtube.com/embed/dQw4w9WgXcQ'}]};
                            app.router('lms');
                        }, 1000); return;
                    }

                    const payload = {
                        action: 'login',
                        email: document.getElementById('lms-email').value,
                        password: document.getElementById('lms-pass').value
                    };

                    await app.sendData(payload, (res) => {
                        if(res.status === 'success') { app.user = res; app.router('lms'); }
                        else { alert("Credenciales incorrectas"); btn.innerText = "Ingresar al Aula"; }
                    });
                },

                submitContact: async (e) => {
                    e.preventDefault();
                    const payload = {
                        action: 'contacto',
                        nombre: document.getElementById('c-name').value,
                        email: document.getElementById('c-email').value,
                        asunto: document.getElementById('c-subject').value,
                        mensaje: document.getElementById('c-msg').value
                    };
                    const btn = e.target.querySelector('button');
                    btn.innerText = "Enviando...";
                    await app.sendData(payload, () => {
                        app.showToast("Mensaje enviado correctamente");
                        e.target.reset();
                        btn.innerText = "Enviar Mensaje";
                    });
                }
            },

            // --- UTILS ---
            toggleCart: () => document.getElementById('cart-sidebar').classList.toggle('hidden'),
            openCheckout: () => { app.toggleCart(); document.getElementById('checkout-modal').classList.remove('hidden'); },
            showToast: (msg) => { const t = document.getElementById('toast'); document.getElementById('toast-msg').innerText = msg; t.classList.remove('opacity-0', 'translate-y-20'); setTimeout(()=>t.classList.add('opacity-0', 'translate-y-20'), 3000); },
            
            initSlider: () => {
                let slideIndex = 0;
                setInterval(() => {
                    const slides = document.querySelectorAll('.slide');
                    if(slides.length > 0) {
                        slides.forEach(s => s.classList.remove('active'));
                        slideIndex = (slideIndex + 1) % slides.length;
                        slides[slideIndex].classList.add('active');
                    }
                }, 6000);
            },

            sendData: async (data, cb) => {
                if(MOCK_MODE) return setTimeout(() => cb({status:'success', idPedido:'DEMO-123'}), 1000);
                try {
                    await fetch(API_URL, { method: 'POST', body: JSON.stringify(data), headers: {"Content-Type": "text/plain;charset=utf-8"} });
                    cb({status:'success'});
                } catch(e) { console.error(e); alert("Error de conexión"); }
            }
        };

        // INICIAR APP
        document.addEventListener('DOMContentLoaded', app.init);
    </script>
</body>
</html>
